#! D:/Program Files/Nuke8.0v4/nuke-8.0.v4.dll -nx
version 8.0 v4
define_window_layout_xml {<?xml version="1.0" encoding="UTF-8"?>
<layout version="1.0">
    <window x="-4" y="-4" w="1792" h="1088" screen="0">
        <splitter orientation="1">
            <split size="1299"/>
            <splitter orientation="1">
                <split size="49"/>
                <dock id="" hideTitles="1" activePageId="Toolbar.1">
                    <page id="Toolbar.1"/>
                </dock>
                <split size="1246"/>
                <splitter orientation="2">
                    <split size="605"/>
                    <dock id="" activePageId="Viewer.1">
                        <page id="Viewer.1"/>
                    </dock>
                    <split size="425"/>
                    <dock id="" activePageId="DAG.1">
                        <page id="DAG.1"/>
                        <page id="Curve Editor.1"/>
                        <page id="DopeSheet.1"/>
                    </dock>
                </splitter>
            </splitter>
            <split size="481"/>
            <dock id="" activePageId="Properties.1">
                <page id="Properties.1"/>
            </dock>
        </splitter>
    </window>
</layout>
}
Root {
 inputs 0
 name "E:/Users/KsKZ/Documents/_KZ Project/_KZDev/_scripts/_Nuke/env_Sph_tool_kz/env_Sph_tool_kz_v09.nk"
 format "2048 1556 0 0 2048 1556 1 2K_Super_35(full-ap)"
 proxy_type scale
 proxy_format "1024 778 0 0 1024 778 1 1K_Super_35(full-ap)"
}
BackdropNode {
 inputs 0
 name BackdropNode1
 tile_color 0x388e8e00
 note_font_size 42
 xpos 266
 ypos -443
 bdwidth 518
 bdheight 519
}
StickyNote {
 inputs 0
 name StickyNote1
 label "assign object alpha here!"
 note_font_size 36
 xpos -1062
 ypos 320
}
StickyNote {
 inputs 0
 name StickyNote3
 label "normal camera pass"
 note_font_size 24
 xpos -805
 ypos -448
}
StickyNote {
 inputs 0
 name StickyNote4
 label "Environment map"
 note_font_size 36
 xpos 346
 ypos -596
}
Read {
 inputs 0
 file E:/Users/KsKZ/Documents/maya/projects/default/images/ironman_helmet/ironman_helmet_bty.1.exr
 format "1280 720 0 0 1280 720 0.999562 "
 origset true
 colorspace linear
 name Read1
 xpos -164
 ypos 194
}
set C2d964e20 [stack 0]
Grade {
 gamma 0.64
 name Grade3
 xpos -164
 ypos 307
}
set N2dc19210 [stack 0]
Read {
 inputs 0
 file E:/Users/KsKZ/Documents/maya/projects/default/images/ironman_helmet/ironman_helmet_id.1.exr
 format "1280 720 0 0 1280 720 0.999562 "
 origset true
 name Read2
 xpos -451
 ypos -670
}
set C2d965190 [stack 0]
Dot {
 name Dot1
 xpos -417
 ypos -521
}
set N2d965be0 [stack 0]
add_layer {normalCam normalCam.red normalCam.green normalCam.blue normalCam.alpha normalCam.NX normalCam.NY normalCam.NZ}
Shuffle {
 in normalCam
 in2 alpha
 alpha red2
 name Shuffle3
 label normalCam
 xpos -643
 ypos -360
 postage_stamp true
}
push $N2d965be0
add_layer {pointCam pointCam.red pointCam.green pointCam.blue pointCam.alpha}
Shuffle {
 in pointCam
 in2 alpha
 alpha red2
 name Shuffle2
 label pointCamera
 xpos -321
 ypos -359
 postage_stamp true
}
Read {
 inputs 0
 file "E:/Users/KsKZ/Documents/_KZ Project/_KZDev/_scripts/_Nuke/env_Sph_tool_kz/sources/uffizi-large.hdr"
 format "2400 1200 0 0 2400 1200 1 "
 origset true
 name Read6
 xpos 335
 ypos -234
}
Read {
 inputs 0
 file "E:/Users/KsKZ/Documents/_KZ Project/_KZDev/_scripts/_Nuke/env_Sph_tool_kz/sources/Apartment_Spherical_HiRes.hdr"
 format "2048 1024 0 0 2048 1024 1 latLon"
 origset true
 name Read5
 xpos 572
 ypos -256
}
Grade {
 multiply 1.34
 gamma 0.45454
 name Grade2
 xpos 572
 ypos -113
}
Switch {
 inputs 2
 name Switch2
 xpos 335
 ypos -73
}
Group {
 inputs 3
 name Env_sphere_map_KZ1
 tile_color 0xe9ff55ff
 note_font_size 36
 xpos -441
 ypos -86
 addUserKnob {20 parm}
 addUserKnob {6 hideScript l INVISIBLE +INVISIBLE +STARTLINE}
 hideScript {{"\[python -execlocal if(\\ nuke.thisNode().knob(\\\"isFresnel\\\").value()\\ ):\\ntnuke.thisNode().knob(\\\"fre_curve\\\").setEnabled(True)\\ntnuke.thisNode().knob(\\\"fres_ref_zero\\\").setEnabled(True)\\ntnuke.thisNode().knob(\\\"fres_ref_90\\\").setEnabled(True)\\nelse:\\ntnuke.thisNode().knob(\\\"fre_curve\\\").setEnabled(False)\\ntnuke.thisNode().knob(\\\"fres_ref_zero\\\").setEnabled(False)\\ntnuke.thisNode().knob(\\\"fres_ref_90\\\").setEnabled(False)\\nret\\ =\\ 0\\n]"}}
 addUserKnob {7 offset_x l INVISIBLE +INVISIBLE R -1 1}
 addUserKnob {7 offset_y l INVISIBLE -STARTLINE +INVISIBLE R -1 1}
 addUserKnob {7 rot_x l "rotation x" R -1080 1080}
 addUserKnob {7 rot_y l "rotation y" R -1080 1080}
 addUserKnob {12 repeat}
 repeat {1 1}
 addUserKnob {7 res_scale l "res scale" R 0.01 1}
 res_scale 1
 addUserKnob {41 res_filter l "res. filter" T Reformat1.filter}
 addUserKnob {41 blur_size l "blur size" T Blur1.size}
 addUserKnob {26 ""}
 addUserKnob {41 refl_filter l "refl. filter" t "switch to the \"Notch\" if tehre is a banding looking occurred " T STMap2.filter}
 addUserKnob {26 ""}
 addUserKnob {6 isFresnel l fresnel +STARTLINE}
 isFresnel true
 addUserKnob {7 fre_curve l curve R 0 10}
 fre_curve 2.6
 addUserKnob {7 fres_ref_zero l "0 degree ref"}
 fres_ref_zero 0.05
 addUserKnob {7 fres_ref_90 l "90 degree ref" -STARTLINE}
 fres_ref_90 1
 addUserKnob {26 ""}
 addUserKnob {7 IOR +DISABLED R 0.01 5}
 IOR 1.4
 addUserKnob {26 ""}
 addUserKnob {20 t_colorClamp l "color clamp" n 1}
 addUserKnob {26 colorClamp l "color clamp" -STARTLINE}
 addUserKnob {6 Clamp1_disable l disable -STARTLINE}
 Clamp1_disable true
}
 Input {
  inputs 0
  name point_cam
  xpos -55
  ypos -191
  number 1
 }
 Expression {
  temp_name0 v_length
  temp_expr0 "sqrt( r*r + g*g + b*b )"
  expr0 "r/ v_length"
  expr1 "g/ v_length"
  expr2 "b/ v_length"
  name nomailze
  xpos -55
  ypos 131
 }
 set C2d9f56f0 [stack 0]
set N2d9f56f0 [stack 0]
 Invert {
  channels rgb
  name Invert1
  xpos 66
  ypos 363
  disable true
 }
 Input {
  inputs 0
  name normal_cam
  xpos 113
  ypos -177
  number 2
 }
clone $C2d9f56f0 {
  xpos 113
  ypos 231
  selected false
 }
set N2da8c6b0 [stack 0]
 MergeExpression {
  inputs 2
  temp_name0 ior
  temp_expr0 "1/ parent.IOR"
  temp_name1 V
  temp_expr1 "( 0.1, 0.5, 1)"
  temp_name2 N
  temp_expr2 B
  temp_name3 dot_VN
  temp_expr3 "B.r * A.r + B.g * A.g + B.b * A.b"
  expr1 0
  expr2 0
  channel3 alpha
  expr3 0
  name MergeExpression1
  xpos 113
  ypos 421
  disable true
 }
push $N2da8c6b0
push $N2d9f56f0
 Dot {
  name Dot2
  xpos -151
  ypos 135
 }
set N2da8cd90 [stack 0]
 MergeExpression {
  inputs 2
  temp_name0 dot
  temp_expr0 "-1 * ( B.r * A.r + B.g * A.g + B.b * A.b )"
  expr0 dot
  expr1 dot
  channel2 rgb
  expr2 dot
  name MergeExpression2
  xpos 135
  ypos 640
 }
 Grade {
  black {{"\[python 1\\ -\\ nuke.thisGroup().knob(\\\"fres_ref_90\\\").value()]"}}
  add {{"\[python nuke.thisGroup().knob(\\\"fres_ref_zero\\\").value()\\ *\\ -1]"}}
  gamma {{"\[python nuke.thisGroup().knob(\\\"fre_curve\\\").value()]"}}
  white_clamp true
  name Grade2
  xpos 135
  ypos 733
 }
push $N2da8cd90
 Dot {
  name Dot1
  xpos -151
  ypos 324
 }
push $N2da8c6b0
push $N2d9f56f0
 MergeExpression {
  inputs 2
  temp_name0 dot_VN
  temp_expr0 "B.r * A.r + B.g * A.g + B.b * A.b"
  expr0 "2 * dot_VN * Ar"
  expr1 "2 * dot_VN * Ag"
  expr2 "2 * dot_VN * Ab"
  name _2xdot_VN
  xpos -55
  ypos 231
 }
 MergeExpression {
  inputs 2
  expr0 "A.r - B.r"
  expr1 "A.g - B.g"
  expr2 "A.b - B.b"
  expr3 0
  name vec_Rref
  xpos -55
  ypos 320
 }
 Expression {
  expr0 "isnan(r) ? 0 : r"
  expr1 "isnan(g) ? 0 : g"
  expr2 "isnan(b) ? 0 : b"
  name remove_NaN
  xpos -55
  ypos 447
 }
 Expression {
  temp_name0 u
  temp_expr0 "( atan(r,b) + pi )/ (2*pi)"
  temp_name1 v
  temp_expr1 "( asin(g) + 0.5*pi )/ pi"
  expr0 u
  expr1 v
  expr2 0
  expr3 0
  name Expression1
  xpos -55
  ypos 550
 }
 Expression {
  temp_name0 rot_x
  temp_name1 rot_y
  temp_expr1 "parent.rot_y/ 360.0"
  expr0 "abs( (rot_y + r) % 1.0 )"
  expr2 0
  name Expression3
  tile_color 0xba3494ff
  xpos 247
  ypos 550
 }
 Reformat {
  inputs 0
  type scale
  scale {{"\[python nuke.thisGroup().knob(\\\"res_scale\\\").value()]"}}
  name Reformat1
  xpos 249
  ypos 58
 }
 set C2daeed90 [stack 0]
 Expression {
  temp_name0 w
  temp_expr0 Reformat1.width
  temp_name1 h
  temp_expr1 Reformat1.height
  temp_name2 offset_x
  temp_expr2 "-1 * ( parent.offset_x % 1.0 )"
  temp_name3 offset_y
  temp_expr3 "-1 * ( parent.rot_x / 360.0 )"
  expr0 "(((2*asin(sin(2*pi*(( (x+offset_x*2*w) - 0.25*2*w )/(2*w) ))))/pi) / 2)+0.5"
  expr1 "(((2*asin(sin(2*pi*(( (y+offset_y*2*h) - 0.25*2*h )/(2*h) ))))/pi) / 2)+0.5"
  expr2 0
  name Expression2
  xpos 247
  ypos 259
 }
set N2daef100 [stack 0]
 Input {
  inputs 0
  name Env_image
  xpos 423
  ypos -250
 }
 Crop {
  box {{curve} {curve} {Env_image.width} {Env_image.height}}
  reformat true
  intersect true
  crop false
  name Crop1
  xpos 423
  ypos -187
 }
 Tile {
  rows {{"\[python nuke.thisGroup().knob(\\\"repeat\\\").value()\\\[1\\]]"}}
  columns {{"\[python nuke.thisGroup().knob(\\\"repeat\\\").value()\\\[0\\]]"}}
  name Tile1
  xpos 423
  ypos -113
  disable true
 }
clone $C2daeed90 {
  xpos 423
  ypos -45
  selected false
 }
 Blur {
  size {0 0}
  name Blur1
  selected true
  xpos 423
  ypos 113
 }
 Clamp {
  name Clamp1
  xpos 423
  ypos 171
  disable {{parent.Clamp1_disable}}
 }
 STMap {
  inputs 2
  channels rgb
  uv rgb
  name STMap1
  xpos 423
  ypos 259
 }
set N2db72160 [stack 0]
 STMap {
  inputs 2
  channels rgb
  uv rgb
  filter Notch
  name STMap2
  xpos 423
  ypos 550
 }
 Grade {
  whitepoint 0.97
  name Grade3
  xpos 423
  ypos 576
 }
 Grade {
  inputs 1+1
  multiply 0
  maskChannelMask rgba.red
  name Grade1
  xpos 423
  ypos 733
  disable {{"\[python 1\\ -\\ nuke.thisGroup().knob(\\\"isFresnel\\\").value()]"}}
 }
set N2db72bb0 [stack 0]
 Output {
  name Output1
  xpos 423
  ypos 835
 }
push $N2daef100
push $N2db72160
push $N2db72bb0
 Viewer {
  inputs 3
  input_number 1
  viewerProcess rec709
  input_process false
  name Viewer1
  xpos 247
  ypos 650
 }
end_group
set N356b350 [stack 0]
Grade {
 multiply 5
 name Grade4
 xpos -441
 ypos 223
}
Copy {
 inputs 2
 from0 rgba.red
 to0 rgba.alpha
 name Copy4
 xpos -441
 ypos 301
}
Premult {
 name Premult
 xpos -441
 ypos 388
}
set N2db73600 [stack 0]
Grade {
 gamma 0.295
 unpremult rgba.alpha
 name Grade1
 xpos -441
 ypos 504
 disable true
}
push $N2dc19210
Merge2 {
 inputs 2
 operation screen
 name Merge1
 xpos -164
 ypos 510
}
push $N356b350
Viewer {
 inputs 2
 frame 259
 frame_range 1-360
 frame_range_lock true
 input_number 1
 viewerProcess rec709
 input_process false
 name Viewer2
 xpos -142
 ypos 702
}
StickyNote {
 inputs 0
 name StickyNote2
 label "point camera pass"
 note_font_size 24
 xpos -335
 ypos -442
}
clone $C2d965190 {
 inputs 0
 xpos -399
 ypos -980
 selected false
}
clone $C2d964e20 {
 inputs 0
 xpos -134
 ypos -984
 selected false
}
push $N2db73600
push 0
Viewer {
 inputs 2
 frame 1
 input_number 1
 colour_sample_bbox {0.217187494 -0.04376915097 0.21875 -0.04220596701}
 input_process false
 name Viewer1
 selected true
 xpos 177
 ypos 165
}
